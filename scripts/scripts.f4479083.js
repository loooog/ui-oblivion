"use strict";angular.module("oblivionApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("oblivionApp").controller("MainCtrl",["$scope",function(){}]),angular.module("oblivionApp").directive("node",function(){return{templateUrl:"views/node.html",restrict:"E",scope:{serial:"@serial",number:"@number",dmx:"@dmx"},link:function(){}}}),angular.module("oblivionApp").directive("randomText",function(){return{templateUrl:"views/randomText.html",restrict:"E",scope:{type:"@type"},link:function(){}}}),angular.module("oblivionApp").directive("droneTable",["dataService",function(a){return{templateUrl:"views/droneTable.html",restrict:"E",link:function(b){b.droneTable=a.getDroneTable()}}}]).directive("test",function(){return{restrict:"A",link:function(a,b){2==a.$index||5==a.$index?b.css("width",(b.parent().width()-1)/3-10):b.css("width",(b.parent().width()-1)/3+4)}}}),angular.module("oblivionApp").directive("identifications",function(){return{templateUrl:"views/identifications.html",restrict:"E",link:function(a){a.drones=[{id:"Z1"},{id:"Z2"},{id:"Z3"},{id:"Z4"},{id:"Z5"},{id:"Z6"},{id:"Z7"},{id:"Z8"}]}}}),angular.module("oblivionApp").directive("identification",function(){return{templateUrl:"views/identification.html",restrict:"E",link:function(){}}}),angular.module("oblivionApp").directive("diagnosticMatrix",function(){return{templateUrl:"views/diagnosticMatrix.html",restrict:"E",link:function(){}}}),angular.module("oblivionApp").directive("fuelStatus",["dataService",function(a){return{templateUrl:"views/fuelStatus.html",restrict:"E",link:function(b){b.fuelStatus=a.getFuelStatus()}}}]),angular.module("oblivionApp").directive("positionData",function(){return{templateUrl:"views/positionData.html",restrict:"E",link:function(){}}}),angular.module("oblivionApp").directive("ammunition",function(){return{templateUrl:"views/ammunition.html",restrict:"E",link:function(){}}}),angular.module("oblivionApp").directive("energyUsage",["dataService",function(a){return{templateUrl:"views/energyUsage.html",restrict:"E",link:function(b){b.energyUsage=a.getEnergyUsage()}}}]),angular.module("oblivionApp").directive("drone",function(){return{templateUrl:"views/drone.html",restrict:"E",link:function(){}}}),angular.module("oblivionApp").directive("modelViewer",function(){return{restrict:"E",link:function(a,b){function c(a,b,c){k=new THREE.Matrix4,k.makeRotationAxis(b.normalize(),c),a.matrix.multiply(k),a.rotation.setFromRotationMatrix(a.matrix)}var d,e,f,g,h,i=b[0].offsetWidth,j=b[0].offsetHeight;a.init=function(){d=new THREE.PerspectiveCamera(90,i/j,.3,1e3),d.position.z=1.5,e=new THREE.Scene,h=new THREE.JSONLoader,h.load("images/drone.js",function(b){g=new THREE.Mesh(b,new THREE.MeshBasicMaterial({wireframe:!0,color:"rgb(126,208,223)"})),e.add(g),a.animate()}),f=new THREE.WebGLRenderer({antialias:!0}),f.setClearColor(0,0),f.setSize(i,j),b[0].appendChild(f.domElement)},a.animate=function(){requestAnimationFrame(a.animate),a.render()};var k,l=new THREE.Vector3(0,1,0);a.render=function(){c(g,l,Math.PI/180),f.render(e,d)},a.init()}}}),angular.module("oblivionApp").directive("vizCircular",function(){return{restrict:"E",scope:{size:"@"},link:function(a,b){b.css("width",a.size),b.css("height",a.size),d3.select(b[0]).append("svg").append("circle").attr({cx:a.size/2,cy:a.size/2,r:a.size/2,stroke:"rgba(126,208,223,.2)"})}}}),angular.module("oblivionApp").directive("vizFuel",["$interval",function(a){return{restrict:"E",scope:{percent:"@"},link:function(b,c){var d=c.width()*b.percent,e=10,f=2.5,g=1,h=_.range(d/f),i=d3.select(c[0]).append("svg").attr({width:d,height:e});i.selectAll("rect").data(h).enter().append("rect").attr({x:function(a,b){return b*f},y:0,height:e,width:f-g,fill:function(a,b){return b<=.4*h.length?"rgb(45,57,64)":b<=.6*h.length?"rgb(95,132,138)":b<=.8*h.length?"rgb(90,186,201)":b<=.9*h.length?"rgb(188,245,235)":"rgb(236,248,191)"}}),a(function(){h.pop()},1e3)}}}]),angular.module("oblivionApp").directive("dotGrid",function(){return{restrict:"E",link:function(a,b){var c=b.width(),d=b.height(),e=10,f=d3.range(e,d,e),g=d3.range(e,c,e),h=d3.select(b[0]).append("svg").attr({width:c,height:d});h.selectAll("line.vertical").data(g).enter().append("svg:line").attr("x1",function(a){return a}).attr("y1",e).attr("x2",function(a){return a}).attr("y2",d-e).style("stroke","rgba(110,110,110,.1)").style("stroke-width",1),h.selectAll("line.horizontal").data(f).enter().append("svg:line").attr("x1",e).attr("y1",function(a){return a}).attr("x2",c-e).attr("y2",function(a){return a}).style("stroke","rgba(110,110,110,.1)").style("stroke-width",1)}}}),angular.module("oblivionApp").factory("dataService",["$interval",function(){var a=function(){this.num=_.random(50,300)},b=function(){this.tank_1=_.random(30,90)/100,this.tank_2=_.random(30,90)/100,this.thrust=_.random(30,90)/100};return{getFuelStatus:function(){var a=[];return _.each(_.range(2),function(c){a[c]=new b}),a},getDroneTable:function(){var b=[];return _.each(_.range(6),function(c){b[c]=[],_.each(_.range(3),function(d){b[c][d]=new a})}),b},getEnergyUsage:function(){var a=[];return _.each(_.range(15),function(b){a[b]=[],_.each(_.range(6),function(c){a[b][c]=100*_.random(1)})}),console.log(a),a}}}]),angular.module("oblivionApp").directive("dispatchedDrone",["$interval",function(a){return{templateUrl:"/views/dispatchedDrone.html",restrict:"E",link:function(b){a(function(){b.drone.num--},_.random(2e3,1e4))}}}]),angular.module("oblivionApp").directive("vizEnergyUsage",function(){return{restrict:"E",link:function(a,b){{var c=Math.floor(b.parent().width()/a.energyUsage.length),d=b.height();d3.select(b[0]).append("svg").attr({w:c,height:d})}}}});